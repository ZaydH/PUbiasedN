p_num: 1000
u_num: 50000
pi: 0.4

training_epochs: 50
p_batch_size: 100
u_batch_size: 5000
learning_rate: 0.001
weight_decay: 0.01

non_negative: True
loss_type: density

Files already downloaded and verified
Files already downloaded and verified
Test set: Accuracy: 3973.0/10000 (39.73%)
Epoch: 0  Train Loss: -0.608615
Test set: Accuracy: 7553.0/10000 (75.53%)
Epoch: 1  Train Loss: -1.171493
Test set: Accuracy: 8092.0/10000 (80.92%)
Epoch: 2  Train Loss: -1.329221
Test set: Accuracy: 8133.0/10000 (81.33%)
Epoch: 3  Train Loss: -1.333149
Test set: Accuracy: 8186.0/10000 (81.86%)
Epoch: 4  Train Loss: -1.401148
Test set: Accuracy: 8258.0/10000 (82.58%)
Epoch: 5  Train Loss: -1.441927
Test set: Accuracy: 8489.0/10000 (84.89%)
Epoch: 6  Train Loss: -1.517989
Test set: Accuracy: 8551.0/10000 (85.51%)
Epoch: 7  Train Loss: -1.570830
Test set: Accuracy: 8470.0/10000 (84.70%)
Epoch: 8  Train Loss: -1.562418
Test set: Accuracy: 8510.0/10000 (85.10%)
Epoch: 9  Train Loss: -1.629636
Test set: Accuracy: 8522.0/10000 (85.22%)

Test set: Accuracy: 5747.0/10000 (57.47%)
0.6296963691711426
0.6277697086334229
0.6397920250892639
0.6310777068138123
0.6315762996673584
0.6339340209960938
0.6308462023735046
0.6312554478645325
0.6361863613128662
0.6286866068840027
Epoch: 0  Train Loss: 7.405239
Test set: Accuracy: 6000.0/10000 (60.00%)
0.6335577368736267
0.6347150206565857
0.6283553838729858
0.6256825923919678
0.6390467286109924
0.6316871047019958
0.6323142051696777
0.6346481442451477
0.6352909207344055
0.6350555419921875
Epoch: 1  Train Loss: 6.905523
Test set: Accuracy: 6000.0/10000 (60.00%)
0.6327370405197144
0.6303318738937378
0.631411075592041
0.6283472776412964
0.633924126625061
0.6362281441688538
0.6318905353546143
0.623760461807251
0.6401474475860596
0.6326555013656616
Epoch: 2  Train Loss: 6.862933
Test set: Accuracy: 6000.0/10000 (60.00%)
0.634597659111023
0.6255755424499512
0.6349098086357117
0.6286587715148926
0.6290622353553772
0.6262328624725342
0.6285507678985596
0.6352784633636475
0.634170651435852
0.6315498352050781
Epoch: 3  Train Loss: 6.739482
Test set: Accuracy: 6000.0/10000 (60.00%)
0.6338402628898621
0.6285114884376526
0.6369208693504333
0.6383479833602905
0.6320632696151733
0.6250913143157959
0.6363750696182251
0.6341398358345032
0.6330393552780151
0.633822500705719
Epoch: 4  Train Loss: 6.699622
Test set: Accuracy: 6036.0/10000 (60.36%)
0.6342730522155762
0.6310540437698364
0.6374185681343079
0.6345803737640381
0.6331003904342651
0.6307246685028076
0.6336548328399658
0.634114146232605
0.6318728923797607
0.6418006420135498
Epoch: 5  Train Loss: 6.589149
Test set: Accuracy: 6663.0/10000 (66.63%)
0.6348305940628052
0.6289304494857788
0.6326399445533752
0.6353834867477417
0.63897305727005
0.6316629648208618
0.6402788162231445
0.6286896467208862
0.6283620595932007
0.6234543919563293
Epoch: 6  Train Loss: 6.625140
Test set: Accuracy: 6001.0/10000 (60.01%)
0.6336578726768494
0.6232007145881653
0.6386964321136475
0.6327396631240845
0.6367848515510559
0.6322287917137146
0.6265631914138794
0.6333003640174866
0.6389316916465759
0.6290770173072815
Epoch: 7  Train Loss: 6.528722
Test set: Accuracy: 6705.0/10000 (67.05%)
0.6329059600830078
0.6243679523468018
0.631705641746521
0.6361255645751953
0.6288735866546631
0.6421768069267273
0.6361033320426941
0.6309938430786133
0.6369578242301941
0.6260639429092407
Epoch: 8  Train Loss: 6.410695
Test set: Accuracy: 6586.0/10000 (65.86%)
0.6367935538291931
0.6256678700447083
0.6344930529594421
0.6350574493408203
0.6350253224372864
0.6285074949264526
0.6373597979545593
0.6309157609939575
0.6289559006690979
0.6276811957359314
Epoch: 9  Train Loss: 6.320315
Test set: Accuracy: 6892.0/10000 (68.92%)
Train dr model Test set: Accuracy: 8505.0/10000 (85.05%)
0.5755887031555176
0.5771123170852661
0.5757383108139038
0.5687657594680786
0.5780997276306152
0.5831773281097412
0.5717521905899048
0.571158766746521
0.5676014423370361
0.5794826745986938
Epoch: 10  Train Loss: 6.317598
Test set: Accuracy: 6832.0/10000 (68.32%)
0.5694263577461243
0.5796208381652832
0.5690290927886963
0.5713117122650146
0.5784498453140259
0.5798803567886353
0.5757846236228943
0.5756494998931885
0.5641160011291504
0.5731358528137207
Epoch: 11  Train Loss: 6.236968
Test set: Accuracy: 6896.0/10000 (68.96%)
0.5757185220718384
0.5731594562530518
0.5724151134490967
0.5770500898361206
0.5780092477798462
0.5720455050468445
0.5651462078094482
0.5831115245819092
0.5680912137031555
0.5664380788803101
Epoch: 12  Train Loss: 6.353268
Test set: Accuracy: 6876.0/10000 (68.76%)
0.5716995000839233
0.5649168491363525
0.5747110247612
0.5744203329086304
0.5718040466308594
0.5704822540283203
0.5789916515350342
0.578539252281189
0.5728877782821655
0.5763405561447144
Epoch: 13  Train Loss: 6.217729
Test set: Accuracy: 6892.0/10000 (68.92%)
0.5715928077697754
0.5752003192901611
0.5704001188278198
0.5709210634231567
0.5676097273826599
0.5776165723800659
0.5699571371078491
0.5659846067428589
0.5655373334884644
0.5660083889961243
Epoch: 14  Train Loss: 6.162039
Test set: Accuracy: 6745.0/10000 (67.45%)
0.5692895650863647
0.5741966962814331
0.5697420835494995
0.5718592405319214
0.5792665481567383
0.567882776260376
0.5716687440872192
0.580054759979248
0.5791926383972168
0.560641884803772
Epoch: 15  Train Loss: 6.248395
Test set: Accuracy: 6486.0/10000 (64.86%)
0.5743142366409302
0.5748537182807922
0.5766973495483398
0.5772821307182312
0.5676584839820862
0.5814458131790161
0.5680403709411621
0.5770323276519775
0.5718157291412354
0.5738744735717773
Epoch: 16  Train Loss: 6.228796
Test set: Accuracy: 6920.0/10000 (69.20%)
0.567964494228363
0.5821927785873413
0.5696454048156738
0.5691251754760742
0.5723624229431152
0.5673807263374329
0.5732768774032593
0.5809098482131958
0.567514181137085
0.5632627010345459
Epoch: 17  Train Loss: 6.140854
Test set: Accuracy: 6943.0/10000 (69.43%)
0.5655796527862549
0.576765775680542
0.5777990818023682
0.5785446763038635
0.5748996138572693
0.5678797364234924
0.5753490924835205
0.5704169869422913
0.5630871653556824
0.5684345960617065
Epoch: 18  Train Loss: 6.045626
Test set: Accuracy: 7027.0/10000 (70.27%)
0.5744568109512329
0.576637864112854
0.5784650444984436
0.5692094564437866
0.5785359144210815
0.5731643438339233
0.5679023265838623
0.5640609264373779
0.5714918375015259
0.5769357681274414
Epoch: 19  Train Loss: 5.969630
Test set: Accuracy: 7138.0/10000 (71.38%)
Train dr model Test set: Accuracy: 8432.0/10000 (84.32%)
0.6514365673065186
0.6533933877944946
0.6485699415206909
0.6517086029052734
0.649868369102478
0.6501175761222839
0.6553500890731812
0.6501857042312622
0.6509108543395996
0.6457650661468506
Epoch: 20  Train Loss: 5.943342
Test set: Accuracy: 7219.0/10000 (72.19%)
0.6563136577606201
0.6466432809829712
0.6456841230392456
0.6530614495277405
0.6441669464111328
0.649472713470459
0.6402442455291748
0.6461349725723267
0.648482084274292
0.6453678607940674
Epoch: 21  Train Loss: 5.947987
Test set: Accuracy: 7319.0/10000 (73.19%)
0.6594628095626831
0.6547688841819763
0.6454216241836548
0.6501773595809937
0.6561659574508667
0.6541315317153931
0.6483340263366699
0.6514671444892883
0.6501429677009583
0.641468346118927
Epoch: 22  Train Loss: 5.927115
Test set: Accuracy: 7406.0/10000 (74.06%)
0.6468709111213684
0.6502600908279419
0.6546090245246887
0.6488614082336426
0.6469961404800415
0.6485715508460999
0.6489888429641724
0.650712251663208
0.6430058479309082
0.644263744354248
Epoch: 23  Train Loss: 6.004184
Test set: Accuracy: 7413.0/10000 (74.13%)
0.6454818844795227
0.6485235095024109
0.6448736190795898
0.6432515382766724
0.6427069902420044
0.6514966487884521
0.6347253322601318
0.6542694568634033
0.6533842086791992
0.6499278545379639
Epoch: 24  Train Loss: 5.851266
Test set: Accuracy: 7593.0/10000 (75.93%)
0.6477209329605103
0.652104377746582
0.6485946774482727
0.6489635705947876
0.6480156183242798
0.6391353607177734
0.6490180492401123
0.6517858505249023
0.6539099216461182
0.6473643779754639
Epoch: 25  Train Loss: 5.660080
Test set: Accuracy: 7838.0/10000 (78.38%)
0.6532825827598572
0.6452853679656982
0.6476311683654785
0.6519975662231445
0.6425487995147705
0.6584202647209167
0.6410759091377258
0.6576910614967346
0.6455681324005127
0.6508480310440063
Epoch: 26  Train Loss: 5.557223
Test set: Accuracy: 7622.0/10000 (76.22%)
0.6475012302398682
0.6506960391998291
0.6476612091064453
0.64866042137146
0.6390143632888794
0.6541845202445984
0.6496542692184448
0.6478012800216675
0.6555472612380981
0.6495612859725952
Epoch: 27  Train Loss: 5.429955
Test set: Accuracy: 7616.0/10000 (76.16%)
0.6492525339126587
0.6533827781677246
0.6526771783828735
0.6506576538085938
0.6492474675178528
0.6438313722610474
0.6543206572532654
0.6481568813323975
0.6500375270843506
0.6382089257240295
Epoch: 28  Train Loss: 5.944022
Test set: Accuracy: 6708.0/10000 (67.08%)
0.6500022411346436
0.6573699116706848
0.6516813039779663
0.6462327241897583
0.638168454170227
0.6493109464645386
0.6533602476119995
0.6503384113311768
0.6418598890304565
0.6464129686355591
Epoch: 29  Train Loss: 5.725967
Test set: Accuracy: 6148.0/10000 (61.48%)
Train dr model Test set: Accuracy: 8274.0/10000 (82.74%)
0.6907438039779663
0.6941344738006592
0.6876851916313171
0.6971420049667358
0.6961790323257446
0.6957369446754456
0.6961754560470581
0.6928167343139648
0.6835236549377441
0.6944587230682373
Epoch: 30  Train Loss: 6.118636
Test set: Accuracy: 7852.0/10000 (78.52%)
0.6940739154815674
0.6856732368469238
0.6915178894996643
0.6941894888877869
0.6942068338394165
0.6951889991760254
0.6929203271865845
0.6897709369659424
0.693346381187439
0.6875409483909607
Epoch: 31  Train Loss: 5.645329
Test set: Accuracy: 7877.0/10000 (78.77%)
0.6929272413253784
0.695529580116272
0.6946632862091064
0.6836711168289185
0.6897438764572144
0.6903101205825806
0.6894781589508057
0.697189450263977
0.6957436800003052
0.6850073337554932
Epoch: 32  Train Loss: 5.580153
Test set: Accuracy: 7805.0/10000 (78.05%)
0.6862527132034302
0.696054220199585
0.6947338581085205
0.6852529048919678
0.6916167736053467
0.6915346384048462
0.6852622032165527
0.6937687397003174
0.6923727989196777
0.6893579959869385
Epoch: 33  Train Loss: 5.493257
Test set: Accuracy: 7844.0/10000 (78.44%)
0.6891639232635498
0.6895384788513184
0.6921955943107605
0.7020089030265808
0.690784752368927
0.6960924863815308
0.6882219314575195
0.6900285482406616
0.6892000436782837
0.6824015378952026
Epoch: 34  Train Loss: 5.411700
Test set: Accuracy: 7953.0/10000 (79.53%)
0.6867150068283081
0.6963021755218506
0.6910499334335327
0.7067029476165771
0.694364070892334
0.6937587857246399
0.69281405210495
0.68781977891922
0.6864550113677979
0.6898374557495117
Epoch: 35  Train Loss: 5.331536
Test set: Accuracy: 7930.0/10000 (79.30%)
0.6860913038253784
0.6888515949249268
0.6949450969696045
0.6838823556900024
0.688682496547699
0.6967779397964478
0.6888279318809509
0.6929582953453064
0.6920671463012695
0.6885969638824463
Epoch: 36  Train Loss: 5.309183
Test set: Accuracy: 8019.0/10000 (80.19%)
0.6894421577453613
0.6932767629623413
0.6944977641105652
0.6988716721534729
0.6925907135009766
0.6927391290664673
0.6863361597061157
0.6943340301513672
0.6939923763275146
0.6924769878387451
Epoch: 37  Train Loss: 5.239749
Test set: Accuracy: 8002.0/10000 (80.02%)
0.6955915689468384
0.6962343454360962
0.6945303678512573
0.6941903233528137
0.6908938884735107
0.6862434148788452
0.696806013584137
0.6862949132919312
0.6940122842788696
0.6863802075386047
Epoch: 38  Train Loss: 5.225251
Test set: Accuracy: 8030.0/10000 (80.30%)
0.6904923319816589
0.6915532350540161
0.6859598159790039
0.6934217214584351
0.6934094429016113
0.6886293888092041
0.6913444995880127
0.6919705867767334
0.6874664425849915
0.6869206428527832
Epoch: 39  Train Loss: 5.138280
Test set: Accuracy: 8072.0/10000 (80.72%)
Train dr model Test set: Accuracy: 8208.0/10000 (82.08%)
0.6957092881202698
0.7041015028953552
0.6993200778961182
0.6944073438644409
0.690605103969574
0.6941626071929932
0.6921678781509399
0.6955626010894775
0.6985571384429932
0.6963536143302917
Epoch: 40  Train Loss: 5.143788
Test set: Accuracy: 8030.0/10000 (80.30%)
0.7031214237213135
0.6948437094688416
0.6970654726028442
0.7015258073806763
0.6987065076828003
0.6964373588562012
0.6961348056793213
0.7010561227798462
0.6972051858901978
0.7005923390388489
Epoch: 41  Train Loss: 5.093959
Test set: Accuracy: 7889.0/10000 (78.89%)
0.6966515779495239
0.6957738995552063
0.6986243724822998
0.6972298622131348
0.6934524774551392
0.7032659649848938
0.7024881839752197
0.6953390836715698
0.6991631984710693
0.69898521900177
Epoch: 42  Train Loss: 5.120812
Test set: Accuracy: 8033.0/10000 (80.33%)
0.6969512701034546
0.6948590874671936
0.6929402947425842
0.6942195892333984
0.693616509437561
0.7023392915725708
0.7004439830780029
0.691129207611084
0.6920210123062134
0.6946563720703125
Epoch: 43  Train Loss: 5.069928
Test set: Accuracy: 8117.0/10000 (81.17%)
0.6972124576568604
0.6922163963317871
0.7002446055412292
0.6879688501358032
0.6979246139526367
0.6951162815093994
0.6978986263275146
0.7017108201980591
0.6971840858459473
0.6969411373138428
Epoch: 44  Train Loss: 4.999537
Test set: Accuracy: 7999.0/10000 (79.99%)
0.7058576941490173
0.6947911977767944
0.692771315574646
0.6938393115997314
0.6968774795532227
0.6940049529075623
0.6844838261604309
0.6964664459228516
0.6949317455291748
0.6931173205375671
Epoch: 45  Train Loss: 4.911404
Test set: Accuracy: 7242.0/10000 (72.42%)
0.6951780319213867
0.6935746669769287
0.6973757743835449
0.6971690058708191
0.7053837776184082
0.6970950365066528
0.7001391649246216
0.7018964290618896
0.700599193572998
0.7022734880447388
Epoch: 46  Train Loss: 5.405778
Test set: Accuracy: 7700.0/10000 (77.00%)
0.6963495016098022
0.7016415596008301
0.6881775856018066
0.7040021419525146
0.6919642686843872
0.7012729644775391
0.689597487449646
0.7014113068580627
0.6945918798446655
0.6997822523117065
Epoch: 47  Train Loss: 5.135767
Test set: Accuracy: 7854.0/10000 (78.54%)
0.6975558996200562
0.6928400993347168
0.6947283744812012
0.7038106322288513
0.7007991075515747
0.6981499195098877
0.7071824073791504
0.7008575797080994
0.6992320418357849
0.691379725933075
Epoch: 48  Train Loss: 4.963729
Test set: Accuracy: 8091.0/10000 (80.91%)
0.6977840662002563
0.7075876593589783
0.6950483918190002
0.6994388699531555
0.6947829723358154
0.6947935819625854
0.6899385452270508
0.7030010223388672
0.6968689560890198
0.7000477910041809
Epoch: 49  Train Loss: 4.929303
Test set: Accuracy: 8110.0/10000 (81.10%)
Train dr model Test set: Accuracy: 7931.0/10000 (79.31%)
